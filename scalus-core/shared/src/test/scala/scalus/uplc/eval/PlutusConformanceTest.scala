package scalus
package uplc
package eval

import org.scalatest.funsuite.AnyFunSuite
import scalus.uplc.builtin.platform
import scalus.cardano.ledger.{CardanoInfo, Language, MajorProtocolVersion}

import scala.util.Failure
import scala.util.Success
import scala.util.Try

/** Tests for the Plutus Conformance Test Suite. */
abstract class PlutusConformanceTest extends AnyFunSuite:
    protected lazy val plutusVM: PlutusVM = {
        val costModelJson = new String(
          platform.readFile("scalus-core/shared/src/main/resources/builtinCostModelC.json"),
          "UTF-8"
        )
        val builtinCostModel = BuiltinCostModel.fromJsonString(costModelJson)
        val baseParams = MachineParams.fromCostModels(
          CardanoInfo.mainnet.protocolParams.costModels,
          Language.PlutusV4,
          MajorProtocolVersion.dijkstraPV
        )
        val params = MachineParams(baseParams.machineCosts, builtinCostModel)
        PlutusVM.makePlutusV4VM(params)
    }

    protected given PlutusVM = plutusVM
    // Run this command in plutus-conformance to generate the test cases
    // find . -name "*.uplc" -print0 | sort -zf | xargs -0 -I {} bash -c 'file="{}"; rel_path="${file#./}"; without_ext="${rel_path%.uplc}"; echo "check(\"$without_ext\")"'

    // disable scalafmt for the following block
    // format: off
    check("builtin/constant/bool/boolean/boolean")
    check("builtin/constant/bool/false-lc/false-lc")
    check("builtin/constant/bool/False/False")
    check("builtin/constant/bool/Maybe/Maybe")
    check("builtin/constant/bool/true-lc/true-lc")
    check("builtin/constant/bool/True/True")
    check("builtin/constant/bytestring/bytestring-01/bytestring-01")
    check("builtin/constant/bytestring/bytestring-02/bytestring-02")
    check("builtin/constant/bytestring/bytestring-03/bytestring-03")
    check("builtin/constant/bytestring/bytestring-04/bytestring-04")
    check("builtin/constant/data/dataByteString/dataByteString")
    check("builtin/constant/data/dataConstr/dataConstr")
    check("builtin/constant/data/dataInteger/dataInteger")
    check("builtin/constant/data/dataList/dataList")
    check("builtin/constant/data/dataMap/dataMap")
    check("builtin/constant/data/dataMisByteString/dataMisByteString")
    check("builtin/constant/data/dataMisConstr/dataMisConstr")
    check("builtin/constant/data/dataMisInteger/dataMisInteger")
    check("builtin/constant/data/dataMisList/dataMisList")
    check("builtin/constant/data/dataMisMap/dataMisMap")
    check("builtin/constant/integer/integer-01/integer-01")
    check("builtin/constant/integer/integer-02/integer-02")
    check("builtin/constant/integer/integer-03/integer-03")
    check("builtin/constant/integer/integer-04/integer-04")
    check("builtin/constant/integer/integer-05/integer-05")
    check("builtin/constant/integer/integer-06/integer-06")
    check("builtin/constant/integer/integer-07/integer-07")
    check("builtin/constant/integer/integer-08/integer-08")
    check("builtin/constant/integer/integer-09/integer-09")
    check("builtin/constant/integer/integer10/integer10")
    check("builtin/constant/list/emptyList/emptyList")
    check("builtin/constant/list/illTypedList-01/illTypedList-01")
    check("builtin/constant/list/illTypedList-02/illTypedList-02")
    check("builtin/constant/list/simpleList/simpleList")
    check("builtin/constant/list/unitList/unitList")
    check("builtin/constant/pair/illTypedNestedPair/illTypedNestedPair")
    check("builtin/constant/pair/illTypedPair-01/illTypedPair-01")
    check("builtin/constant/pair/illTypedPair-02/illTypedPair-02")
    check("builtin/constant/pair/nestedPair/nestedPair")
    check("builtin/constant/pair/simplePair/simplePair")
    // Plutus 1.53 - Array type
    check("builtin/constant/array/emptyArray/emptyArray")
    check("builtin/constant/array/illTypedArray-01/illTypedArray-01")
    check("builtin/constant/array/illTypedArray-02/illTypedArray-02")
    check("builtin/constant/array/simpleArray/simpleArray")
    check("builtin/constant/array/unitArray/unitArray")
    check("builtin/constant/string/string-01/string-01")
    check("builtin/constant/string/string-02/string-02")
    check("builtin/constant/string/string-03/string-03")
    check("builtin/constant/string/string-04/string-04")
    check("builtin/constant/string/string-05/string-05")
    check("builtin/constant/string/string-06/string-06")
    // TODO: Plutus 1.53 - new string test cases
    ignore("builtin/constant/string/string-07/string-07")(())
    ignore("builtin/constant/string/string-08/string-08")(())
    check("builtin/constant/unit/unit-fail-1/unit-fail-1")
    check("builtin/constant/unit/unit-fail-2/unit-fail-2")
    check("builtin/constant/unit/unit/unit")
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/constant/value/duplicate-keys/duplicate-keys")(())
    ignore("builtin/constant/value/empty-tokens/empty-tokens")(())
    ignore("builtin/constant/value/empty/empty")(())
    ignore("builtin/constant/value/ill-formed/ill-formed")(())
    ignore("builtin/constant/value/key-too-long-1/key-too-long-1")(())
    ignore("builtin/constant/value/key-too-long-2/key-too-long-2")(())
    ignore("builtin/constant/value/max-key-length-1/max-key-length-1")(())
    ignore("builtin/constant/value/max-key-length-2/max-key-length-2")(())
    ignore("builtin/constant/value/multi/multi")(())
    ignore("builtin/constant/value/no-overflow/no-overflow")(())
    ignore("builtin/constant/value/no-underflow/no-underflow")(())
    ignore("builtin/constant/value/overflow/overflow")(())
    ignore("builtin/constant/value/underflow/underflow")(())
    ignore("builtin/constant/value/unordered/unordered")(())
    ignore("builtin/constant/value/zero-asset/zero-asset")(())
    // BLS12-381 constant parsing tests
    check("builtin/constant/bls12-381/G1/bad-syntax-01/bad-syntax-01")
    check("builtin/constant/bls12-381/G1/bad-syntax-02/bad-syntax-02")
    check("builtin/constant/bls12-381/G1/bad-zero-01/bad-zero-01")
    check("builtin/constant/bls12-381/G1/bad-zero-02/bad-zero-02")
    check("builtin/constant/bls12-381/G1/bad-zero-03/bad-zero-03")
    check("builtin/constant/bls12-381/G1/off-curve/off-curve")
    check("builtin/constant/bls12-381/G1/on-curve-bit3-clear/on-curve-bit3-clear")
    check("builtin/constant/bls12-381/G1/on-curve-bit3-set/on-curve-bit3-set")
    check("builtin/constant/bls12-381/G1/on-curve-serialised-not-compressed/on-curve-serialised-not-compressed")
    check("builtin/constant/bls12-381/G1/out-of-group/out-of-group")
    check("builtin/constant/bls12-381/G1/too-long/too-long")
    check("builtin/constant/bls12-381/G1/too-short/too-short")
    check("builtin/constant/bls12-381/G1/zero/zero")
    check("builtin/constant/bls12-381/G2/bad-syntax-01/bad-syntax-01")
    check("builtin/constant/bls12-381/G2/bad-syntax-02/bad-syntax-02")
    check("builtin/constant/bls12-381/G2/bad-zero-01/bad-zero-01")
    check("builtin/constant/bls12-381/G2/bad-zero-02/bad-zero-02")
    check("builtin/constant/bls12-381/G2/bad-zero-03/bad-zero-03")
    check("builtin/constant/bls12-381/G2/off-curve/off-curve")
    check("builtin/constant/bls12-381/G2/on-curve-bit3-clear/on-curve-bit3-clear")
    check("builtin/constant/bls12-381/G2/on-curve-bit3-set/on-curve-bit3-set")
    check("builtin/constant/bls12-381/G2/on-curve-serialised-not-compressed/on-curve-serialised-not-compressed")
    check("builtin/constant/bls12-381/G2/out-of-group/out-of-group")
    check("builtin/constant/bls12-381/G2/too-long/too-long")
    check("builtin/constant/bls12-381/G2/too-short/too-short")
    check("builtin/constant/bls12-381/G2/zero/zero")
    check("builtin/interleaving/ite/ite")
    check("builtin/interleaving/iteAtIntegerArrowIntegerApplied1/iteAtIntegerArrowIntegerApplied1")
    check("builtin/interleaving/iteAtIntegerArrowIntegerApplied2/iteAtIntegerArrowIntegerApplied2")
    check("builtin/interleaving/iteAtIntegerArrowIntegerAppliedApplied/iteAtIntegerArrowIntegerAppliedApplied")
    check("builtin/interleaving/iteAtIntegerArrowIntegerWithCond/iteAtIntegerArrowIntegerWithCond")
    check("builtin/interleaving/iteForceAppForce/iteForceAppForce")
    check("builtin/interleaving/iteForced/iteForced")
    check("builtin/interleaving/iteForcedForced/iteForcedForced")
    check("builtin/interleaving/iteForcedWithIntegerAndString/iteForcedWithIntegerAndString")
    check("builtin/interleaving/iteStringInteger/iteStringInteger")
    check("builtin/interleaving/iteStringString/iteStringString")
    check("builtin/interleaving/iteUnforcedFullyApplied/iteUnforcedFullyApplied")
    check("builtin/interleaving/iteUnforcedWithCond/iteUnforcedWithCond")
    check("builtin/interleaving/iteWrongCondTypeFullyAppied/iteWrongCondTypeFullyAppied")
    check("builtin/interleaving/iteWrongCondTypePartiallyApplied/iteWrongCondTypePartiallyApplied")
    check("builtin/interleaving/multiplyIntegerForceError1/multiplyIntegerForceError1")
    check("builtin/interleaving/multiplyIntegerForceError2/multiplyIntegerForceError2")
    check("builtin/interleaving/multiplyIntegerForceError3/multiplyIntegerForceError3")
    check("builtin/semantics/addInteger/addInteger-01/addInteger-01")
    check("builtin/semantics/addInteger/addInteger-02/addInteger-02")
    check("builtin/semantics/addInteger/addInteger-03/addInteger-03")
    check("builtin/semantics/addInteger/addInteger-04/addInteger-04")
    check("builtin/semantics/addInteger/addInteger-uncurried/addInteger-uncurried")
    check("builtin/semantics/andByteString/case-01/case-01")
    check("builtin/semantics/andByteString/case-02/case-02")
    check("builtin/semantics/andByteString/case-03/case-03")
    check("builtin/semantics/andByteString/case-04/case-04")
    check("builtin/semantics/andByteString/case-05/case-05")
    check("builtin/semantics/andByteString/case-06/case-06")
    check("builtin/semantics/andByteString/case-07/case-07")
    check("builtin/semantics/andByteString/case-08/case-08")
    check("builtin/semantics/andByteString/case-09/case-09")
    check("builtin/semantics/andByteString/case-10/case-10")
    check("builtin/semantics/andByteString/case-11/case-11")
    check("builtin/semantics/andByteString/case-12/case-12")
    check("builtin/semantics/andByteString/case-13/case-13")
    check("builtin/semantics/andByteString/case-14/case-14")
    check("builtin/semantics/appendByteString/appendByteString-01/appendByteString-01")
    check("builtin/semantics/appendByteString/appendByteString-02/appendByteString-02")
    check("builtin/semantics/appendByteString/appendByteString-03/appendByteString-03")
    check("builtin/semantics/appendString/appendString")
    check("builtin/semantics/bData/bData")
    check("builtin/semantics/blake2b_224/blake2b_224-empty/blake2b_224-empty")
    check("builtin/semantics/blake2b_224/blake2b_224-length-200/blake2b_224-length-200")
    check("builtin/semantics/blake2b_256/blake2b_256-empty/blake2b_256-empty")
    check("builtin/semantics/blake2b_256/blake2b_256-length-200/blake2b_256-length-200")
    // BLS12-381 semantics tests
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G1/arith/add/add")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G1/arith/neg/neg")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G1/arith/scalarMul/scalarMul")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G1/uncompress/off-curve/off-curve")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G1/uncompress/out-of-group/out-of-group")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G2/arith/add/add")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G2/arith/neg/neg")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G2/arith/scalarMul/scalarMul")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G2/uncompress/off-curve/off-curve")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/G2/uncompress/out-of-group/out-of-group")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/balanced/balanced")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/left-additive/left-additive")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/left-multiplicative/left-multiplicative")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/right-additive/right-additive")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/right-multiplicative/right-multiplicative")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/pairing/swap-scalars/swap-scalars")
    check("builtin/semantics/bls12_381-cardano-crypto-tests/signature/augmented/augmented")
    // FIXME: This test is failing because blst Java binding for hash_to receives a String for DST
    //  and then converts it to a byte array as UTF-8. This is a bug in the Java bindings.
    // Here is the discussion: https://github.com/supranational/blst/pull/232
    // For now, we are skipping this test.
    ignore("builtin/semantics/bls12_381-cardano-crypto-tests/signature/large-dst/large-dst")(())
    check("builtin/semantics/bls12_381_G1_add/add-associative/add-associative")
    check("builtin/semantics/bls12_381_G1_add/add-commutative/add-commutative")
    check("builtin/semantics/bls12_381_G1_add/add-zero/add-zero")
    check("builtin/semantics/bls12_381_G1_add/add/add")
    check("builtin/semantics/bls12_381_G1_compress/compress/compress")
    check("builtin/semantics/bls12_381_G1_equal/equal-false/equal-false")
    check("builtin/semantics/bls12_381_G1_equal/equal-true/equal-true")
    check("builtin/semantics/bls12_381_G1_hashToGroup/hash-different-msg-same-dst/hash-different-msg-same-dst")
    // FIXME: This test is failing because blst Java binding for hash_to receives a String for DST
    //  and then converts it to a byte array as UTF-8. This is a bug in the Java bindings.
    // Here is the discussion: https://github.com/supranational/blst/pull/232
    // For now, we are skipping this test.
    ignore("builtin/semantics/bls12_381_G1_hashToGroup/hash-dst-len-255/hash-dst-len-255")(())
    check("builtin/semantics/bls12_381_G1_hashToGroup/hash-dst-len-256/hash-dst-len-256")
    check("builtin/semantics/bls12_381_G1_hashToGroup/hash-empty-dst/hash-empty-dst")
    check("builtin/semantics/bls12_381_G1_hashToGroup/hash-same-msg-different-dst/hash-same-msg-different-dst")
    check("builtin/semantics/bls12_381_G1_hashToGroup/hash/hash")
    check("builtin/semantics/bls12_381_G1_neg/add-neg/add-neg")
    check("builtin/semantics/bls12_381_G1_neg/neg-zero/neg-zero")
    check("builtin/semantics/bls12_381_G1_neg/neg/neg")
    check("builtin/semantics/bls12_381_G1_scalarMul/addmul/addmul")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul-44/mul-44")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul-neg-one/mul-neg-one")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul-one/mul-one")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul-zero/mul-zero")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul19+25/mul19+25")
    check("builtin/semantics/bls12_381_G1_scalarMul/mul4x-11/mul4x-11")
    check("builtin/semantics/bls12_381_G1_scalarMul/muladd/muladd")
    check("builtin/semantics/bls12_381_G1_scalarMul/mulneg-44/mulneg-44")
    check("builtin/semantics/bls12_381_G1_scalarMul/mulperiodic-01/mulperiodic-01")
    check("builtin/semantics/bls12_381_G1_scalarMul/mulperiodic-02/mulperiodic-02")
    check("builtin/semantics/bls12_381_G1_scalarMul/mulperiodic-03/mulperiodic-03")
    check("builtin/semantics/bls12_381_G1_scalarMul/mulperiodic-04/mulperiodic-04")
    check("builtin/semantics/bls12_381_G1_uncompress/bad-zero-01/bad-zero-01")
    check("builtin/semantics/bls12_381_G1_uncompress/bad-zero-02/bad-zero-02")
    check("builtin/semantics/bls12_381_G1_uncompress/bad-zero-03/bad-zero-03")
    check("builtin/semantics/bls12_381_G1_uncompress/off-curve/off-curve")
    check("builtin/semantics/bls12_381_G1_uncompress/on-curve-bit1-clear/on-curve-bit1-clear")
    check("builtin/semantics/bls12_381_G1_uncompress/on-curve-bit3-clear/on-curve-bit3-clear")
    check("builtin/semantics/bls12_381_G1_uncompress/on-curve-bit3-set/on-curve-bit3-set")
    check("builtin/semantics/bls12_381_G1_uncompress/on-curve-serialised-not-compressed/on-curve-serialised-not-compressed")
    check("builtin/semantics/bls12_381_G1_uncompress/out-of-group/out-of-group")
    check("builtin/semantics/bls12_381_G1_uncompress/too-long/too-long")
    check("builtin/semantics/bls12_381_G1_uncompress/too-short/too-short")
    check("builtin/semantics/bls12_381_G1_uncompress/zero/zero")
    check("builtin/semantics/bls12_381_G2_add/add-associative/add-associative")
    check("builtin/semantics/bls12_381_G2_add/add-commutative/add-commutative")
    check("builtin/semantics/bls12_381_G2_add/add-zero/add-zero")
    check("builtin/semantics/bls12_381_G2_add/add/add")
    check("builtin/semantics/bls12_381_G2_compress/compress/compress")
    check("builtin/semantics/bls12_381_G2_equal/equal-false/equal-false")
    check("builtin/semantics/bls12_381_G2_equal/equal-true/equal-true")
    check("builtin/semantics/bls12_381_G2_hashToGroup/hash-different-msg-same-dst/hash-different-msg-same-dst")
    // FIXME: This test is failing because blst Java binding for hash_to receives a String for DST
    //  and then converts it to a byte array as UTF-8. This is a bug in the Java bindings.
    // Here is the discussion: https://github.com/supranational/blst/pull/232
    // For now, we are skipping this test.
    ignore("builtin/semantics/bls12_381_G2_hashToGroup/hash-dst-len-255/hash-dst-len-255")(())
    check("builtin/semantics/bls12_381_G2_hashToGroup/hash-dst-len-256/hash-dst-len-256")
    check("builtin/semantics/bls12_381_G2_hashToGroup/hash-empty-dst/hash-empty-dst")
    check("builtin/semantics/bls12_381_G2_hashToGroup/hash-same-msg-different-dst/hash-same-msg-different-dst")
    check("builtin/semantics/bls12_381_G2_hashToGroup/hash/hash")
    check("builtin/semantics/bls12_381_G2_neg/add-neg/add-neg")
    check("builtin/semantics/bls12_381_G2_neg/neg-zero/neg-zero")
    check("builtin/semantics/bls12_381_G2_neg/neg/neg")
    check("builtin/semantics/bls12_381_G2_scalarMul/addmul/addmul")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul-44/mul-44")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul-neg-one/mul-neg-one")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul-one/mul-one")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul-zero/mul-zero")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul19+25/mul19+25")
    check("builtin/semantics/bls12_381_G2_scalarMul/mul4x-11/mul4x-11")
    check("builtin/semantics/bls12_381_G2_scalarMul/muladd/muladd")
    check("builtin/semantics/bls12_381_G2_scalarMul/mulneg-44/mulneg-44")
    check("builtin/semantics/bls12_381_G2_scalarMul/mulperiodic-01/mulperiodic-01")
    check("builtin/semantics/bls12_381_G2_scalarMul/mulperiodic-02/mulperiodic-02")
    check("builtin/semantics/bls12_381_G2_scalarMul/mulperiodic-03/mulperiodic-03")
    check("builtin/semantics/bls12_381_G2_scalarMul/mulperiodic-04/mulperiodic-04")
    check("builtin/semantics/bls12_381_G2_uncompress/bad-zero-01/bad-zero-01")
    check("builtin/semantics/bls12_381_G2_uncompress/bad-zero-02/bad-zero-02")
    check("builtin/semantics/bls12_381_G2_uncompress/bad-zero-03/bad-zero-03")
    check("builtin/semantics/bls12_381_G2_uncompress/off-curve/off-curve")
    check("builtin/semantics/bls12_381_G2_uncompress/on-curve-bit1-clear/on-curve-bit1-clear")
    check("builtin/semantics/bls12_381_G2_uncompress/on-curve-bit3-clear/on-curve-bit3-clear")
    check("builtin/semantics/bls12_381_G2_uncompress/on-curve-bit3-set/on-curve-bit3-set")
    check("builtin/semantics/bls12_381_G2_uncompress/on-curve-serialised-not-compressed/on-curve-serialised-not-compressed")
    check("builtin/semantics/bls12_381_G2_uncompress/out-of-group/out-of-group")
    check("builtin/semantics/bls12_381_G2_uncompress/too-long/too-long")
    check("builtin/semantics/bls12_381_G2_uncompress/too-short/too-short")
    check("builtin/semantics/bls12_381_G2_uncompress/zero/zero")
    check("builtin/semantics/bls12_381_millerLoop/balanced/balanced")
    check("builtin/semantics/bls12_381_millerLoop/equal-pairing/equal-pairing")
    check("builtin/semantics/bls12_381_millerLoop/left-additive/left-additive")
    check("builtin/semantics/bls12_381_millerLoop/random-pairing/random-pairing")
    check("builtin/semantics/bls12_381_millerLoop/right-additive/right-additive")
    // BLS12-381 multiScalarMul G1 tests
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-01/multiScalarMul-01")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-02a/multiScalarMul-02a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-02b/multiScalarMul-02b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-03a/multiScalarMul-03a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-03b/multiScalarMul-03b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-04a/multiScalarMul-04a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-04b/multiScalarMul-04b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-05a/multiScalarMul-05a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-05b/multiScalarMul-05b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-06a/multiScalarMul-06a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-06b/multiScalarMul-06b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-07/multiScalarMul-07")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-08/multiScalarMul-08")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-09a/multiScalarMul-09a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-09b/multiScalarMul-09b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-10a/multiScalarMul-10a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-10b/multiScalarMul-10b")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-11/multiScalarMul-11")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-12a/multiScalarMul-12a")
    check("builtin/semantics/bls12_381_G1_multiScalarMul/multiScalarMul-12b/multiScalarMul-12b")
    // BLS12-381 multiScalarMul G2 tests
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-01/multiScalarMul-01")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-02a/multiScalarMul-02a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-02b/multiScalarMul-02b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-03a/multiScalarMul-03a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-03b/multiScalarMul-03b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-04a/multiScalarMul-04a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-04b/multiScalarMul-04b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-05a/multiScalarMul-05a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-05b/multiScalarMul-05b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-06a/multiScalarMul-06a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-06b/multiScalarMul-06b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-07/multiScalarMul-07")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-08/multiScalarMul-08")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-09a/multiScalarMul-09a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-09b/multiScalarMul-09b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-10a/multiScalarMul-10a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-10b/multiScalarMul-10b")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-11/multiScalarMul-11")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-12a/multiScalarMul-12a")
    check("builtin/semantics/bls12_381_G2_multiScalarMul/multiScalarMul-12b/multiScalarMul-12b")
    check("builtin/semantics/byteStringToInteger/big-endian/all-zeros/all-zeros")
    check("builtin/semantics/byteStringToInteger/big-endian/correct-output/correct-output")
    check("builtin/semantics/byteStringToInteger/big-endian/empty/empty")
    check("builtin/semantics/byteStringToInteger/big-endian/leading-zeros/leading-zeros")
    check("builtin/semantics/byteStringToInteger/both-endian/both-endian")
    check("builtin/semantics/byteStringToInteger/little-endian/all-zeros/all-zeros")
    check("builtin/semantics/byteStringToInteger/little-endian/correct-output/correct-output")
    check("builtin/semantics/byteStringToInteger/little-endian/empty/empty")
    check("builtin/semantics/byteStringToInteger/little-endian/trailing-zeros/trailing-zeros")
    check("builtin/semantics/chooseDataByteString/chooseDataByteString")
    check("builtin/semantics/chooseDataConstr/chooseDataConstr")
    check("builtin/semantics/chooseDataInteger/chooseDataInteger")
    check("builtin/semantics/chooseDataList/chooseDataList")
    check("builtin/semantics/chooseDataMap/chooseDataMap")
    check("builtin/semantics/chooseList/chooseList-01/chooseList-01")
    check("builtin/semantics/chooseList/chooseList-02/chooseList-02")
    check("builtin/semantics/chooseList/chooseList-03/chooseList-03")
    check("builtin/semantics/chooseList/chooseList-04/chooseList-04")
    check("builtin/semantics/chooseUnit/chooseUnit-01/chooseUnit-01")
    check("builtin/semantics/chooseUnit/chooseUnit-02/chooseUnit-02")
    check("builtin/semantics/complementByteString/case-01/case-01")
    check("builtin/semantics/complementByteString/case-02/case-02")
    check("builtin/semantics/complementByteString/case-03/case-03")
    check("builtin/semantics/complementByteString/case-04/case-04")
    check("builtin/semantics/complementByteString/case-05/case-05")
    check("builtin/semantics/consByteString/consByteString-01/consByteString-01")
    check("builtin/semantics/consByteString/consByteString-02/consByteString-02")
    check("builtin/semantics/consByteString/consByteString-03/consByteString-03")
    check("builtin/semantics/constrData/constrData")
    check("builtin/semantics/countSetBits/case-01/case-01")
    check("builtin/semantics/countSetBits/case-02/case-02")
    check("builtin/semantics/countSetBits/case-03/case-03")
    check("builtin/semantics/countSetBits/case-04/case-04")
    check("builtin/semantics/countSetBits/case-05/case-05")
    check("builtin/semantics/countSetBits/case-06/case-06")
    check("builtin/semantics/countSetBits/case-07/case-07")
    check("builtin/semantics/countSetBits/case-08/case-08")
    check("builtin/semantics/decodeUtf8/decodeUtf8-invalid/decodeUtf8-invalid")
    check("builtin/semantics/decodeUtf8/decodeUtf8-ok/decodeUtf8-ok")
    check("builtin/semantics/divideInteger/divideInteger-01/divideInteger-01")
    check("builtin/semantics/divideInteger/divideInteger-neg-neg/divideInteger-neg-neg")
    check("builtin/semantics/divideInteger/divideInteger-neg-pos/divideInteger-neg-pos")
    check("builtin/semantics/divideInteger/divideInteger-pos-neg/divideInteger-pos-neg")
    check("builtin/semantics/divideInteger/divideInteger-pos-pos/divideInteger-pos-pos")
    check("builtin/semantics/divideInteger/divideInteger-zero/divideInteger-zero")
    // Plutus 1.53 - dropList builtin
    check("builtin/semantics/dropList/dropList-01/dropList-01")
    check("builtin/semantics/dropList/dropList-02/dropList-02")
    check("builtin/semantics/dropList/dropList-03/dropList-03")
    check("builtin/semantics/dropList/dropList-04/dropList-04")
    check("builtin/semantics/dropList/dropList-05/dropList-05")
    check("builtin/semantics/dropList/dropList-06/dropList-06")
    check("builtin/semantics/dropList/dropList-07/dropList-07")
    check("builtin/semantics/dropList/dropList-08/dropList-08")
    check("builtin/semantics/dropList/dropList-09/dropList-09")
    check("builtin/semantics/dropList/dropList-10/dropList-10")
    check("builtin/semantics/dropList/dropList-11/dropList-11")
    check("builtin/semantics/dropList/dropList-12/dropList-12")
    check("builtin/semantics/dropList/dropList-13/dropList-13")
    check("builtin/semantics/dropList/dropList-14/dropList-14")
    check("builtin/semantics/dropList/dropList-15/dropList-15")
    check("builtin/semantics/dropList/dropList-16/dropList-16")
    check("builtin/semantics/encodeUtf8/encodeUtf8")
    check("builtin/semantics/equalsByteString/equalsByteString-01/equalsByteString-01")
    check("builtin/semantics/equalsByteString/equalsByteString-02/equalsByteString-02")
    check("builtin/semantics/equalsByteString/equalsByteString/equalsByteString")
    check("builtin/semantics/equalsData/equalsData-01/equalsData-01")
    check("builtin/semantics/equalsData/equalsData-02/equalsData-02")
    check("builtin/semantics/equalsData/equalsData-03/equalsData-03")
    check("builtin/semantics/equalsData/equalsData-04/equalsData-04")
    check("builtin/semantics/equalsInteger/equalsInteger-01/equalsInteger-01")
    check("builtin/semantics/equalsInteger/equalsInteger-02/equalsInteger-02")
    check("builtin/semantics/equalsInteger/equalsInteger-03/equalsInteger-03")
    check("builtin/semantics/equalsString/equalsString-01/equalsString-01")
    check("builtin/semantics/equalsString/equalsString-02/equalsString-02")
    // CIP-109 expModInteger tests
    check("builtin/semantics/expModInteger/exp-neg-non-inverse-01/exp-neg-non-inverse-01")
    check("builtin/semantics/expModInteger/exp-neg-non-inverse-02/exp-neg-non-inverse-02")
    check("builtin/semantics/expModInteger/expMod-01/expMod-01")
    check("builtin/semantics/expModInteger/expMod-02/expMod-02")
    check("builtin/semantics/expModInteger/expMod-03/expMod-03")
    check("builtin/semantics/expModInteger/expMod-04/expMod-04")
    check("builtin/semantics/expModInteger/expMod-05/expMod-05")
    check("builtin/semantics/expModInteger/mod-neg/mod-neg")
    check("builtin/semantics/expModInteger/mod-zero/mod-zero")
    // Extra expModInteger tests
    check("builtin/semantics/expModInteger/extra/expModInteger-01/expModInteger-01")
    check("builtin/semantics/expModInteger/extra/expModInteger-02/expModInteger-02")
    check("builtin/semantics/expModInteger/extra/expModInteger-03/expModInteger-03")
    check("builtin/semantics/expModInteger/extra/expModInteger-04/expModInteger-04")
    check("builtin/semantics/expModInteger/extra/expModInteger-05/expModInteger-05")
    check("builtin/semantics/expModInteger/extra/expModInteger-06/expModInteger-06")
    check("builtin/semantics/expModInteger/extra/expModInteger-07/expModInteger-07")
    check("builtin/semantics/expModInteger/extra/expModInteger-08/expModInteger-08")
    check("builtin/semantics/expModInteger/extra/expModInteger-09/expModInteger-09")
    check("builtin/semantics/expModInteger/extra/expModInteger-10/expModInteger-10")
    check("builtin/semantics/expModInteger/extra/expModInteger-11/expModInteger-11")
    check("builtin/semantics/expModInteger/extra/expModInteger-12/expModInteger-12")
    check("builtin/semantics/expModInteger/extra/expModInteger-13/expModInteger-13")
    check("builtin/semantics/expModInteger/extra/expModInteger-14/expModInteger-14")
    check("builtin/semantics/expModInteger/extra/expModInteger-15/expModInteger-15")
    check("builtin/semantics/expModInteger/extra/expModInteger-16/expModInteger-16")
    check("builtin/semantics/expModInteger/extra/expModInteger-17/expModInteger-17")
    check("builtin/semantics/expModInteger/extra/expModInteger-18/expModInteger-18")
    check("builtin/semantics/expModInteger/extra/expModInteger-19/expModInteger-19")
    check("builtin/semantics/expModInteger/extra/expModInteger-20/expModInteger-20")
    check("builtin/semantics/expModInteger/extra/expModInteger-21/expModInteger-21")
    check("builtin/semantics/expModInteger/extra/expModInteger-22/expModInteger-22")
    check("builtin/semantics/expModInteger/extra/expModInteger-23/expModInteger-23")
    check("builtin/semantics/expModInteger/extra/expModInteger-24/expModInteger-24")
    check("builtin/semantics/expModInteger/extra/expModInteger-25/expModInteger-25")
    check("builtin/semantics/expModInteger/extra/expModInteger-26/expModInteger-26")
    check("builtin/semantics/expModInteger/extra/expModInteger-27/expModInteger-27")
    check("builtin/semantics/expModInteger/extra/expModInteger-28/expModInteger-28")
    check("builtin/semantics/expModInteger/extra/expModInteger-29/expModInteger-29")
    check("builtin/semantics/expModInteger/extra/expModInteger-30/expModInteger-30")
    check("builtin/semantics/expModInteger/extra/expModInteger-31/expModInteger-31")
    check("builtin/semantics/expModInteger/extra/expModInteger-32/expModInteger-32")
    check("builtin/semantics/expModInteger/extra/expModInteger-33/expModInteger-33")
    check("builtin/semantics/expModInteger/extra/expModInteger-34/expModInteger-34")
    check("builtin/semantics/expModInteger/extra/expModInteger-35/expModInteger-35")
    check("builtin/semantics/expModInteger/extra/expModInteger-36/expModInteger-36")
    check("builtin/semantics/expModInteger/extra/expModInteger-37/expModInteger-37")
    check("builtin/semantics/expModInteger/extra/expModInteger-38/expModInteger-38")
    check("builtin/semantics/expModInteger/extra/expModInteger-39/expModInteger-39")
    check("builtin/semantics/expModInteger/extra/expModInteger-40/expModInteger-40")
    check("builtin/semantics/expModInteger/extra/expModInteger-41/expModInteger-41")
    check("builtin/semantics/expModInteger/extra/expModInteger-42/expModInteger-42")
    check("builtin/semantics/expModInteger/extra/expModInteger-43/expModInteger-43")
    check("builtin/semantics/expModInteger/extra/expModInteger-44/expModInteger-44")
    check("builtin/semantics/expModInteger/extra/expModInteger-45/expModInteger-45")
    check("builtin/semantics/expModInteger/extra/expModInteger-46/expModInteger-46")
    check("builtin/semantics/expModInteger/extra/expModInteger-47/expModInteger-47")
    check("builtin/semantics/expModInteger/extra/expModInteger-48/expModInteger-48")
    check("builtin/semantics/expModInteger/extra/expModInteger-49/expModInteger-49")
    check("builtin/semantics/expModInteger/extra/expModInteger-50/expModInteger-50")
    check("builtin/semantics/expModInteger/extra/expModInteger-51/expModInteger-51")
    check("builtin/semantics/expModInteger/extra/expModInteger-52/expModInteger-52")
    check("builtin/semantics/expModInteger/extra/expModInteger-53/expModInteger-53")
    check("builtin/semantics/expModInteger/extra/expModInteger-54/expModInteger-54")
    check("builtin/semantics/expModInteger/extra/expModInteger-55/expModInteger-55")
    check("builtin/semantics/expModInteger/extra/expModInteger-56/expModInteger-56")
    check("builtin/semantics/expModInteger/extra/expModInteger-57/expModInteger-57")
    check("builtin/semantics/expModInteger/extra/expModInteger-58/expModInteger-58")
    check("builtin/semantics/expModInteger/extra/expModInteger-59/expModInteger-59")
    check("builtin/semantics/expModInteger/extra/expModInteger-60/expModInteger-60")
    check("builtin/semantics/expModInteger/extra/expModInteger-61/expModInteger-61")
    check("builtin/semantics/expModInteger/extra/expModInteger-62/expModInteger-62")
    check("builtin/semantics/expModInteger/extra/expModInteger-63/expModInteger-63")
    check("builtin/semantics/expModInteger/extra/expModInteger-64/expModInteger-64")
    check("builtin/semantics/expModInteger/extra/expModInteger-65/expModInteger-65")
    check("builtin/semantics/expModInteger/extra/expModInteger-66/expModInteger-66")
    check("builtin/semantics/expModInteger/extra/expModInteger-67/expModInteger-67")
    check("builtin/semantics/expModInteger/extra/expModInteger-68/expModInteger-68")
    check("builtin/semantics/expModInteger/extra/expModInteger-69/expModInteger-69")
    check("builtin/semantics/expModInteger/extra/expModInteger-70/expModInteger-70")
    check("builtin/semantics/expModInteger/extra/expModInteger-71/expModInteger-71")
    check("builtin/semantics/expModInteger/extra/expModInteger-72/expModInteger-72")
    check("builtin/semantics/expModInteger/extra/expModInteger-73/expModInteger-73")
    check("builtin/semantics/expModInteger/extra/expModInteger-74/expModInteger-74")
    check("builtin/semantics/expModInteger/extra/expModInteger-75/expModInteger-75")
    check("builtin/semantics/expModInteger/extra/expModInteger-76/expModInteger-76")
    check("builtin/semantics/expModInteger/extra/expModInteger-77/expModInteger-77")
    check("builtin/semantics/findFirstSetBit/case-01/case-01")
    check("builtin/semantics/findFirstSetBit/case-02/case-02")
    check("builtin/semantics/findFirstSetBit/case-03/case-03")
    check("builtin/semantics/findFirstSetBit/case-04/case-04")
    check("builtin/semantics/findFirstSetBit/case-05/case-05")
    check("builtin/semantics/findFirstSetBit/case-06/case-06")
    check("builtin/semantics/findFirstSetBit/case-07/case-07")
    check("builtin/semantics/fstPair/fstPair")
    check("builtin/semantics/headList/headList-01/headList-01")
    check("builtin/semantics/headList/headList-02/headList-02")
    check("builtin/semantics/headList/headList-03/headList-03")
    check("builtin/semantics/headList/headPartial/headPartial")
    check("builtin/semantics/iData/iData")
    check("builtin/semantics/ifThenElse/ifThenElse-01/ifThenElse-01")
    check("builtin/semantics/ifThenElse/ifThenElse-02/ifThenElse-02")
    check("builtin/semantics/ifThenElse/ifThenElse-03/ifThenElse-03")
    check("builtin/semantics/ifThenElse/ifThenElse-04/ifThenElse-04")
    check("builtin/semantics/ifThenElse/ifThenElse-bad-cond-01/ifThenElse-bad-cond-01")
    check("builtin/semantics/ifThenElse/ifThenElse-bad-cond-02/ifThenElse-bad-cond-02")
    check("builtin/semantics/ifThenElse/ifThenElse-no-force/ifThenElse-no-force")
    check("builtin/semantics/indexArray/indexArray-01/indexArray-01")
    check("builtin/semantics/indexArray/indexArray-02/indexArray-02")
    check("builtin/semantics/indexArray/indexArray-03/indexArray-03")
    check("builtin/semantics/indexByteString/indexByteString-01/indexByteString-01")
    check("builtin/semantics/indexByteString/indexByteStringOOB/indexByteStringOOB")
    check("builtin/semantics/indexByteString/indexByteStringOverflow/indexByteStringOverflow")
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/semantics/insertCoin/key-too-long-1/key-too-long-1")(())
    ignore("builtin/semantics/insertCoin/key-too-long-2/key-too-long-2")(())
    ignore("builtin/semantics/insertCoin/long-key-zero-1/long-key-zero-1")(())
    ignore("builtin/semantics/insertCoin/long-key-zero-2/long-key-zero-2")(())
    ignore("builtin/semantics/insertCoin/multi-ccy-empty/multi-ccy-empty")(())
    ignore("builtin/semantics/insertCoin/multi-ccy-nonempty/multi-ccy-nonempty")(())
    ignore("builtin/semantics/insertCoin/multi-token/multi-token")(())
    ignore("builtin/semantics/insertCoin/negative-empty/negative-empty")(())
    ignore("builtin/semantics/insertCoin/no-overflow/no-overflow")(())
    ignore("builtin/semantics/insertCoin/no-underflow/no-underflow")(())
    ignore("builtin/semantics/insertCoin/overflow/overflow")(())
    ignore("builtin/semantics/insertCoin/positive-empty/positive-empty")(())
    ignore("builtin/semantics/insertCoin/positive-nonempty/positive-nonempty")(())
    ignore("builtin/semantics/insertCoin/underflow/underflow")(())
    ignore("builtin/semantics/insertCoin/zero-positive/zero-positive")(())
    check("builtin/semantics/integerToByteString/big-endian/bounded/correct-output-exact-width/correct-output-exact-width")
    check("builtin/semantics/integerToByteString/big-endian/bounded/correct-output-extra-width/correct-output-extra-width")
    check("builtin/semantics/integerToByteString/big-endian/bounded/max-input-fits-max-width/max-input-fits-max-width")
    check("builtin/semantics/integerToByteString/big-endian/bounded/max-input-width-too-small/max-input-width-too-small")
    check("builtin/semantics/integerToByteString/big-endian/bounded/max-width-input-too-big/max-width-input-too-big")
    check("builtin/semantics/integerToByteString/big-endian/bounded/maximum-width-zero/maximum-width-zero")
    check("builtin/semantics/integerToByteString/big-endian/bounded/negative-input/negative-input")
    check("builtin/semantics/integerToByteString/big-endian/bounded/negative-width/negative-width")
    check("builtin/semantics/integerToByteString/big-endian/bounded/too-narrow/too-narrow")
    check("builtin/semantics/integerToByteString/big-endian/bounded/width-too-big-zero/width-too-big-zero")
    check("builtin/semantics/integerToByteString/big-endian/bounded/zero/zero")
    check("builtin/semantics/integerToByteString/big-endian/unbounded/correct-output/correct-output")
    check("builtin/semantics/integerToByteString/big-endian/unbounded/input-too-big/input-too-big")
    check("builtin/semantics/integerToByteString/big-endian/unbounded/maximum-input/maximum-input")
    check("builtin/semantics/integerToByteString/big-endian/unbounded/negative-input/negative-input")
    check("builtin/semantics/integerToByteString/big-endian/unbounded/zero/zero")
    check("builtin/semantics/integerToByteString/little-endian/bounded/correct-output-exact-width/correct-output-exact-width")
    check("builtin/semantics/integerToByteString/little-endian/bounded/correct-output-extra-width/correct-output-extra-width")
    check("builtin/semantics/integerToByteString/little-endian/bounded/max-input-fits-max-width/max-input-fits-max-width")
    check("builtin/semantics/integerToByteString/little-endian/bounded/max-input-width-too-small/max-input-width-too-small")
    check("builtin/semantics/integerToByteString/little-endian/bounded/max-width-input-too-big/max-width-input-too-big")
    check("builtin/semantics/integerToByteString/little-endian/bounded/maximum-width-zero/maximum-width-zero")
    check("builtin/semantics/integerToByteString/little-endian/bounded/negative-input/negative-input")
    check("builtin/semantics/integerToByteString/little-endian/bounded/negative-width/negative-width")
    check("builtin/semantics/integerToByteString/little-endian/bounded/too-narrow/too-narrow")
    check("builtin/semantics/integerToByteString/little-endian/bounded/width-too-big-zero/width-too-big-zero")
    check("builtin/semantics/integerToByteString/little-endian/bounded/zero/zero")
    check("builtin/semantics/integerToByteString/little-endian/unbounded/correct-output/correct-output")
    check("builtin/semantics/integerToByteString/little-endian/unbounded/input-too-big/input-too-big")
    check("builtin/semantics/integerToByteString/little-endian/unbounded/maximum-input/maximum-input")
    check("builtin/semantics/integerToByteString/little-endian/unbounded/negative-input/negative-input")
    check("builtin/semantics/integerToByteString/little-endian/unbounded/zero/zero")
    check("builtin/semantics/keccak_256/keccak_256-empty/keccak_256-empty")
    check("builtin/semantics/keccak_256/keccak_256-length-200/keccak_256-length-200")
    check("builtin/semantics/lengthOfArray/lengthOfArray-01/lengthOfArray-01")
    check("builtin/semantics/lengthOfArray/lengthOfArray-02/lengthOfArray-02")
    check("builtin/semantics/lengthOfByteString/lengthOfByteString")
    check("builtin/semantics/lessThanByteString/lessThanByteString-00/lessThanByteString-00")
    check("builtin/semantics/lessThanByteString/lessThanByteString-01/lessThanByteString-01")
    check("builtin/semantics/lessThanByteString/lessThanByteString-02/lessThanByteString-02")
    check("builtin/semantics/lessThanByteString/lessThanByteString-03/lessThanByteString-03")
    check("builtin/semantics/lessThanByteString/lessThanByteString-04/lessThanByteString-04")
    check("builtin/semantics/lessThanByteString/lessThanByteString-05/lessThanByteString-05")
    check("builtin/semantics/lessThanEqualsByteString/lessThanEqualsByteString-00/lessThanEqualsByteString-00")
    check("builtin/semantics/lessThanEqualsByteString/lessThanEqualsByteString-01/lessThanEqualsByteString-01")
    check("builtin/semantics/lessThanEqualsByteString/lessThanEqualsByteString-02/lessThanEqualsByteString-02")
    check("builtin/semantics/lessThanEqualsByteString/lessThanEqualsByteString-03/lessThanEqualsByteString-03")
    check("builtin/semantics/lessThanEqualsInteger/lessThanEqualsInteger-01/lessThanEqualsInteger-01")
    check("builtin/semantics/lessThanEqualsInteger/lessThanEqualsInteger-02/lessThanEqualsInteger-02")
    check("builtin/semantics/lessThanEqualsInteger/lessThanEqualsInteger-03/lessThanEqualsInteger-03")
    check("builtin/semantics/lessThanEqualsInteger/lessThanEqualsInteger-04/lessThanEqualsInteger-04")
    check("builtin/semantics/lessThanEqualsInteger/lessThanEqualsInteger-05/lessThanEqualsInteger-05")
    check("builtin/semantics/lessThanInteger/lessThanInteger-01/lessThanInteger-01")
    check("builtin/semantics/lessThanInteger/lessThanInteger-02/lessThanInteger-02")
    check("builtin/semantics/lessThanInteger/lessThanInteger-03/lessThanInteger-03")
    check("builtin/semantics/lessThanInteger/lessThanInteger-04/lessThanInteger-04")
    check("builtin/semantics/lessThanInteger/lessThanInteger-05/lessThanInteger-05")
    check("builtin/semantics/listData/listData")
    check("builtin/semantics/listOfList/listOfList")
    check("builtin/semantics/listOfPair/listOfPair")
    check("builtin/semantics/listToArray/listToArray-01/listToArray-01")
    check("builtin/semantics/listToArray/listToArray-02/listToArray-02")
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/semantics/lookupCoin/absent/absent")(())
    ignore("builtin/semantics/lookupCoin/present/present")(())
    check("builtin/semantics/mapData/mapData")
    check("builtin/semantics/mkCons/divideInteger/divideInteger")
    check("builtin/semantics/mkCons/mkCons-01/mkCons-01")
    check("builtin/semantics/mkCons/mkCons-02/mkCons-02")
    check("builtin/semantics/mkCons/mkCons-fail/mkCons-fail")
    check("builtin/semantics/mkNilData/mkNilData")
    check("builtin/semantics/mkNilPairData/mkNilPairData")
    check("builtin/semantics/mkPairData/mkPairData")
    check("builtin/semantics/modInteger/modInteger-01/modInteger-01")
    check("builtin/semantics/modInteger/modInteger-neg-neg/modInteger-neg-neg")
    check("builtin/semantics/modInteger/modInteger-neg-pos/modInteger-neg-pos")
    check("builtin/semantics/modInteger/modInteger-pos-neg/modInteger-pos-neg")
    check("builtin/semantics/modInteger/modInteger-pos-pos/modInteger-pos-pos")
    check("builtin/semantics/modInteger/modInteger-zero/modInteger-zero")
    check("builtin/semantics/multiplyInteger/multiplyInteger-01/multiplyInteger-01")
    check("builtin/semantics/multiplyInteger/multiplyInteger-02/multiplyInteger-02")
    check("builtin/semantics/multiplyInteger/multiplyInteger-03/multiplyInteger-03")
    check("builtin/semantics/multiplyInteger/multiplyInteger-04/multiplyInteger-04")
    check("builtin/semantics/multiplyInteger/multiplyInteger-05/multiplyInteger-05")
    check("builtin/semantics/multiplyInteger/multiplyInteger-06/multiplyInteger-06")
    check("builtin/semantics/nullList/nullList-01/nullList-01")
    check("builtin/semantics/nullList/nullList-02/nullList-02")
    check("builtin/semantics/orByteString/case-01/case-01")
    check("builtin/semantics/orByteString/case-02/case-02")
    check("builtin/semantics/orByteString/case-03/case-03")
    check("builtin/semantics/orByteString/case-04/case-04")
    check("builtin/semantics/orByteString/case-05/case-05")
    check("builtin/semantics/orByteString/case-06/case-06")
    check("builtin/semantics/orByteString/case-07/case-07")
    check("builtin/semantics/orByteString/case-08/case-08")
    check("builtin/semantics/orByteString/case-09/case-09")
    check("builtin/semantics/orByteString/case-10/case-10")
    check("builtin/semantics/orByteString/case-11/case-11")
    check("builtin/semantics/orByteString/case-12/case-12")
    check("builtin/semantics/orByteString/case-13/case-13")
    check("builtin/semantics/orByteString/case-14/case-14")
    check("builtin/semantics/pairOfPairAndList/pairOfPairAndList")
    check("builtin/semantics/quotientInteger/quotientInteger-01/quotientInteger-01")
    check("builtin/semantics/quotientInteger/quotientInteger-neg-neg/quotientInteger-neg-neg")
    check("builtin/semantics/quotientInteger/quotientInteger-neg-pos/quotientInteger-neg-pos")
    check("builtin/semantics/quotientInteger/quotientInteger-pos-neg/quotientInteger-pos-neg")
    check("builtin/semantics/quotientInteger/quotientInteger-pos-pos/quotientInteger-pos-pos")
    check("builtin/semantics/quotientInteger/quotientInteger-zero/quotientInteger-zero")
    check("builtin/semantics/readBit/case-01/case-01")
    check("builtin/semantics/readBit/case-02/case-02")
    check("builtin/semantics/readBit/case-03/case-03")
    check("builtin/semantics/readBit/case-04/case-04")
    check("builtin/semantics/readBit/case-05/case-05")
    check("builtin/semantics/readBit/case-06/case-06")
    check("builtin/semantics/readBit/case-07/case-07")
    check("builtin/semantics/readBit/case-08/case-08")
    check("builtin/semantics/readBit/case-09/case-09")
    check("builtin/semantics/readBit/case-10/case-10")
    check("builtin/semantics/readBit/case-11/case-11")
    check("builtin/semantics/readBit/case-12/case-12")
    check("builtin/semantics/readBit/case-13/case-13")
    check("builtin/semantics/readBit/case-14/case-14")
    check("builtin/semantics/readBit/case-15/case-15")
    check("builtin/semantics/readBit/case-16/case-16")
    check("builtin/semantics/readBit/case-17/case-17")
    check("builtin/semantics/readBit/case-18/case-18")
    check("builtin/semantics/readBit/case-19/case-19")
    check("builtin/semantics/readBit/case-20/case-20")
    check("builtin/semantics/readBit/case-21/case-21")
    check("builtin/semantics/readBit/case-22/case-22")
    check("builtin/semantics/remainderInteger/remainderInteger-01/remainderInteger-01")
    check("builtin/semantics/remainderInteger/remainderInteger-neg-neg/remainderInteger-neg-neg")
    check("builtin/semantics/remainderInteger/remainderInteger-neg-pos/remainderInteger-neg-pos")
    check("builtin/semantics/remainderInteger/remainderInteger-pos-neg/remainderInteger-pos-neg")
    check("builtin/semantics/remainderInteger/remainderInteger-pos-pos/remainderInteger-pos-pos")
    check("builtin/semantics/remainderInteger/remainderInteger-zero/remainderInteger-zero")
    check("builtin/semantics/replicateByte/case-01/case-01")
    check("builtin/semantics/replicateByte/case-02/case-02")
    check("builtin/semantics/replicateByte/case-03/case-03")
    check("builtin/semantics/replicateByte/case-04/case-04")
    check("builtin/semantics/replicateByte/case-05/case-05")
    check("builtin/semantics/replicateByte/case-06/case-06")
    check("builtin/semantics/replicateByte/case-07/case-07")
    check("builtin/semantics/replicateByte/case-08/case-08")
    check("builtin/semantics/replicateByte/case-09/case-09")
    check("builtin/semantics/replicateByte/case-10/case-10")
    check("builtin/semantics/rotateByteString/case-01/case-01")
    check("builtin/semantics/rotateByteString/case-02/case-02")
    check("builtin/semantics/rotateByteString/case-03/case-03")
    check("builtin/semantics/rotateByteString/case-04/case-04")
    check("builtin/semantics/rotateByteString/case-05/case-05")
    check("builtin/semantics/rotateByteString/case-06/case-06")
    check("builtin/semantics/rotateByteString/case-07/case-07")
    check("builtin/semantics/rotateByteString/case-08/case-08")
    check("builtin/semantics/rotateByteString/case-09/case-09")
    check("builtin/semantics/rotateByteString/case-10/case-10")
    check("builtin/semantics/rotateByteString/case-11/case-11")
    check("builtin/semantics/rotateByteString/case-12/case-12")
    check("builtin/semantics/rotateByteString/case-13/case-13")
    check("builtin/semantics/rotateByteString/case-14/case-14")
    check("builtin/semantics/rotateByteString/case-15/case-15")
    check("builtin/semantics/rotateByteString/case-16/case-16")
    check("builtin/semantics/rotateByteString/case-17/case-17")
    check("builtin/semantics/rotateByteString/case-18/case-18")
    check("builtin/semantics/ripemd_160/ripemd_160-empty/ripemd_160-empty")
    check("builtin/semantics/ripemd_160/ripemd_160-length-200/ripemd_160-length-200")
    check("builtin/semantics/sha2_256/sha2_256-empty/sha2_256-empty")
    check("builtin/semantics/sha2_256/sha2_256-length-200/sha2_256-length-200")
    check("builtin/semantics/sha3_256/sha3_256-empty/sha3_256-empty")
    check("builtin/semantics/sha3_256/sha3_256-length-200/sha3_256-length-200")
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/semantics/scaleValue/by-neg/by-neg")(())
    ignore("builtin/semantics/scaleValue/by-pos/by-pos")(())
    ignore("builtin/semantics/scaleValue/by-zero/by-zero")(())
    ignore("builtin/semantics/scaleValue/no-overflow/no-overflow")(())
    ignore("builtin/semantics/scaleValue/no-underflow/no-underflow")(())
    ignore("builtin/semantics/scaleValue/overflow/overflow")(())
    ignore("builtin/semantics/scaleValue/underflow/underflow")(())
    check("builtin/semantics/shiftByteString/case-01/case-01")
    check("builtin/semantics/shiftByteString/case-02/case-02")
    check("builtin/semantics/shiftByteString/case-03/case-03")
    check("builtin/semantics/shiftByteString/case-04/case-04")
    check("builtin/semantics/shiftByteString/case-05/case-05")
    check("builtin/semantics/shiftByteString/case-06/case-06")
    check("builtin/semantics/shiftByteString/case-07/case-07")
    check("builtin/semantics/shiftByteString/case-08/case-08")
    check("builtin/semantics/shiftByteString/case-09/case-09")
    check("builtin/semantics/shiftByteString/case-10/case-10")
    check("builtin/semantics/shiftByteString/case-11/case-11")
    check("builtin/semantics/shiftByteString/case-12/case-12")
    check("builtin/semantics/shiftByteString/case-13/case-13")
    check("builtin/semantics/shiftByteString/case-14/case-14")
    check("builtin/semantics/shiftByteString/case-15/case-15")
    check("builtin/semantics/sliceByteString/sliceByteString-01/sliceByteString-01")
    check("builtin/semantics/sliceByteString/sliceByteString-02/sliceByteString-02")
    check("builtin/semantics/sliceByteString/sliceByteString-03/sliceByteString-03")
    check("builtin/semantics/sliceByteString/sliceByteString-04/sliceByteString-04")
    check("builtin/semantics/sliceByteString/sliceByteString-05/sliceByteString-05")
    check("builtin/semantics/sndPair/sndPair")
    check("builtin/semantics/subtractInteger-non-iter/subtractInteger-non-iter")
    check("builtin/semantics/subtractInteger/subtractInteger-01/subtractInteger-01")
    check("builtin/semantics/subtractInteger/subtractInteger-02/subtractInteger-02")
    check("builtin/semantics/subtractInteger/subtractInteger-03/subtractInteger-03")
    check("builtin/semantics/subtractInteger/subtractInteger-04/subtractInteger-04")
    check("builtin/semantics/tailList/tailList-01/tailList-01")
    check("builtin/semantics/tailList/tailList-partial/tailList-partial")
    check("builtin/semantics/trace/trace")
    check("builtin/semantics/unBData/unBData-01/unBData-01")
    check("builtin/semantics/unBData/unBData-fail/unBData-fail")
    check("builtin/semantics/unConstrData/unConstrData-01/unConstrData-01")
    check("builtin/semantics/unConstrData/unConstrData-fail/unConstrData-fail")
    check("builtin/semantics/unIData/unIData-01/unIData-01")
    check("builtin/semantics/unIData/unIData-fail/unIData-fail")
    check("builtin/semantics/unListData/unListData-01/unListData-01")
    check("builtin/semantics/unListData/unListData-fail/unListData-fail")
    check("builtin/semantics/unMapData/unMapData-01/unMapData-01")
    check("builtin/semantics/unMapData/unMapData-fail/unMapData-fail")
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/semantics/unionValue/cancel-01/cancel-01")(())
    ignore("builtin/semantics/unionValue/cancel-02/cancel-02")(())
    ignore("builtin/semantics/unionValue/combine/combine")(())
    ignore("builtin/semantics/unionValue/no-overflow/no-overflow")(())
    ignore("builtin/semantics/unionValue/no-underflow/no-underflow")(())
    ignore("builtin/semantics/unionValue/overflow/overflow")(())
    ignore("builtin/semantics/unionValue/underflow/underflow")(())
    ignore("builtin/semantics/unionValue/unitl/unitl")(())
    ignore("builtin/semantics/unionValue/unitr/unitr")(())
    // TODO: enable when UPLC parser supports `(con value ...)` syntax
    ignore("builtin/semantics/valueContains/ccy-missing/ccy-missing")(())
    ignore("builtin/semantics/valueContains/multi-insufficient/multi-insufficient")(())
    ignore("builtin/semantics/valueContains/multi-sufficient/multi-sufficient")(())
    ignore("builtin/semantics/valueContains/neg-empty/neg-empty")(())
    ignore("builtin/semantics/valueContains/neg-neg-eq/neg-neg-eq")(())
    ignore("builtin/semantics/valueContains/neg-neg-gt/neg-neg-gt")(())
    ignore("builtin/semantics/valueContains/neg-neg-lt/neg-neg-lt")(())
    ignore("builtin/semantics/valueContains/neg-pos/neg-pos")(())
    ignore("builtin/semantics/valueContains/pos-empty/pos-empty")(())
    ignore("builtin/semantics/valueContains/pos-neg/pos-neg")(())
    ignore("builtin/semantics/valueContains/reflexive/reflexive")(())
    ignore("builtin/semantics/valueContains/token-missing/token-missing")(())
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/invalid-key/invalid-key")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/long-key/long-key")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/long-msg/long-msg")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/long-sig/long-sig")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/short-key/short-key")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/short-msg/short-msg")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/short-sig/short-sig")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-01/test-vector-01")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-02/test-vector-02")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-03/test-vector-03")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-04/test-vector-04")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-05/test-vector-05")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-06/test-vector-06")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-07/test-vector-07")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-08/test-vector-08")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-09/test-vector-09")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-10/test-vector-10")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-11/test-vector-11")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-12/test-vector-12")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-13/test-vector-13")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-14/test-vector-14")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-15/test-vector-15")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-16/test-vector-16")
    // These tests now work with our custom JNI library that properly parses compact signatures
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-17/test-vector-17")
    check("builtin/semantics/verifyEcdsaSecp256k1Signature/test-vector-18/test-vector-18")
    check("builtin/semantics/verifyEd25519Signature/long-key/long-key")
    check("builtin/semantics/verifyEd25519Signature/long-sig/long-sig")
    check("builtin/semantics/verifyEd25519Signature/short-key/short-key")
    check("builtin/semantics/verifyEd25519Signature/short-sig/short-sig")
    check("builtin/semantics/verifyEd25519Signature/test-vector-01/test-vector-01")
    check("builtin/semantics/verifyEd25519Signature/test-vector-02/test-vector-02")
    check("builtin/semantics/verifyEd25519Signature/test-vector-03/test-vector-03")
    check("builtin/semantics/verifyEd25519Signature/test-vector-04/test-vector-04")
    check("builtin/semantics/verifyEd25519Signature/test-vector-05/test-vector-05")
    check("builtin/semantics/verifyEd25519Signature/test-vector-06/test-vector-06")
    check("builtin/semantics/verifyEd25519Signature/test-vector-07/test-vector-07")
    check("builtin/semantics/verifyEd25519Signature/test-vector-08/test-vector-08")
    check("builtin/semantics/verifyEd25519Signature/test-vector-09/test-vector-09")
    check("builtin/semantics/verifyEd25519Signature/test-vector-10/test-vector-10")
    check("builtin/semantics/verifyEd25519Signature/test-vector-11/test-vector-11")
    check("builtin/semantics/verifyEd25519Signature/test-vector-12/test-vector-12")
    check("builtin/semantics/verifyEd25519Signature/test-vector-13/test-vector-13")
    check("builtin/semantics/verifyEd25519Signature/test-vector-14/test-vector-14")
    check("builtin/semantics/verifyEd25519Signature/test-vector-15/test-vector-15")
    check("builtin/semantics/verifyEd25519Signature/test-vector-16/test-vector-16")
    check("builtin/semantics/verifyEd25519Signature/test-vector-17/test-vector-17")
    check("builtin/semantics/verifyEd25519Signature/test-vector-18/test-vector-18")
    check("builtin/semantics/verifyEd25519Signature/test-vector-19/test-vector-19")
    check("builtin/semantics/verifyEd25519Signature/test-vector-20/test-vector-20")
    check("builtin/semantics/verifyEd25519Signature/test-vector-21/test-vector-21")
    check("builtin/semantics/verifyEd25519Signature/test-vector-22/test-vector-22")
    check("builtin/semantics/verifyEd25519Signature/test-vector-23/test-vector-23")
    check("builtin/semantics/verifyEd25519Signature/test-vector-24/test-vector-24")
    check("builtin/semantics/verifyEd25519Signature/test-vector-25/test-vector-25")
    check("builtin/semantics/verifyEd25519Signature/test-vector-26/test-vector-26")
    check("builtin/semantics/verifyEd25519Signature/test-vector-27/test-vector-27")
    check("builtin/semantics/verifyEd25519Signature/test-vector-28/test-vector-28")
    check("builtin/semantics/verifyEd25519Signature/test-vector-29/test-vector-29")
    check("builtin/semantics/verifyEd25519Signature/test-vector-30/test-vector-30")
    check("builtin/semantics/verifyEd25519Signature/test-vector-31/test-vector-31")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/long-key/long-key")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/long-sig/long-sig")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/short-key/short-key")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/short-sig/short-sig")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-00/test-vector-00")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-01/test-vector-01")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-02/test-vector-02")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-03/test-vector-03")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-04/test-vector-04")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-05/test-vector-05")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-06/test-vector-06")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-07/test-vector-07")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-08/test-vector-08")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-09/test-vector-09")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-10/test-vector-10")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-11/test-vector-11")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-12/test-vector-12")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-13/test-vector-13")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-14/test-vector-14")
    // These tests use variable-length messages (per BIP-340), now supported by our custom JNI library
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-15/test-vector-15")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-16/test-vector-16")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-17/test-vector-17")
    check("builtin/semantics/verifySchnorrSecp256k1Signature/test-vector-18/test-vector-18")
    check("builtin/semantics/writeBits/case-01/case-01")
    check("builtin/semantics/writeBits/case-02/case-02")
    check("builtin/semantics/writeBits/case-03/case-03")
    check("builtin/semantics/writeBits/case-04/case-04")
    check("builtin/semantics/writeBits/case-05/case-05")
    check("builtin/semantics/writeBits/case-06/case-06")
    check("builtin/semantics/writeBits/case-07/case-07")
    check("builtin/semantics/writeBits/case-08/case-08")
    check("builtin/semantics/writeBits/case-09/case-09")
    check("builtin/semantics/writeBits/case-10/case-10")
    check("builtin/semantics/writeBits/case-11/case-11")
    check("builtin/semantics/writeBits/case-12/case-12")
    check("builtin/semantics/writeBits/case-13/case-13")
    check("builtin/semantics/writeBits/case-14/case-14")
    check("builtin/semantics/writeBits/case-15/case-15")
    check("builtin/semantics/writeBits/case-16/case-16")
    check("builtin/semantics/writeBits/case-17/case-17")
    check("builtin/semantics/writeBits/case-18/case-18")
    check("builtin/semantics/writeBits/case-19/case-19")
    check("builtin/semantics/writeBits/case-20/case-20")
    check("builtin/semantics/writeBits/case-21/case-21")
    check("builtin/semantics/writeBits/case-22/case-22")
    check("builtin/semantics/writeBits/case-23/case-23")
    check("builtin/semantics/writeBits/case-24/case-24")
    check("builtin/semantics/writeBits/case-25/case-25")
    check("builtin/semantics/writeBits/case-26/case-26")
    check("builtin/semantics/writeBits/case-27/case-27")
    check("builtin/semantics/writeBits/case-28/case-28")
    check("builtin/semantics/writeBits/case-29/case-29")
    check("builtin/semantics/writeBits/case-30/case-30")
    check("builtin/semantics/writeBits/case-31/case-31")
    check("builtin/semantics/writeBits/case-32/case-32")
    check("builtin/semantics/writeBits/case-33/case-33")
    check("builtin/semantics/writeBits/case-34/case-34")
    check("builtin/semantics/writeBits/case-35/case-35")
    check("builtin/semantics/writeBits/case-36/case-36")
    check("builtin/semantics/writeBits/case-37/case-37")
    check("builtin/semantics/writeBits/case-38/case-38")
    check("builtin/semantics/writeBits/case-39/case-39")
    check("builtin/semantics/writeBits/case-40/case-40")
    check("builtin/semantics/writeBits/case-41/case-41")
    check("builtin/semantics/writeBits/case-42/case-42")
    check("builtin/semantics/writeBits/case-43/case-43")
    check("builtin/semantics/writeBits/case-44/case-44")
    check("builtin/semantics/writeBits/case-45/case-45")
    check("builtin/semantics/writeBits/case-46/case-46")
    check("builtin/semantics/writeBits/case-47/case-47")
    check("builtin/semantics/writeBits/case-48/case-48")
    check("builtin/semantics/xorByteString/case-01/case-01")
    check("builtin/semantics/xorByteString/case-02/case-02")
    check("builtin/semantics/xorByteString/case-03/case-03")
    check("builtin/semantics/xorByteString/case-04/case-04")
    check("builtin/semantics/xorByteString/case-05/case-05")
    check("builtin/semantics/xorByteString/case-06/case-06")
    check("builtin/semantics/xorByteString/case-07/case-07")
    check("builtin/semantics/xorByteString/case-08/case-08")
    check("builtin/semantics/xorByteString/case-09/case-09")
    check("builtin/semantics/xorByteString/case-10/case-10")
    check("builtin/semantics/xorByteString/case-11/case-11")
    check("builtin/semantics/xorByteString/case-12/case-12")
    check("builtin/semantics/xorByteString/case-13/case-13")
    check("builtin/semantics/xorByteString/case-14/case-14")
    check("example/ApplyAdd1/ApplyAdd1")
    check("example/ApplyAdd2/ApplyAdd2")
    check("example/churchSucc/churchSucc")
    check("example/churchZero/churchZero")
    check("example/DivideByZero/DivideByZero")
    check("example/DivideByZeroDrop/DivideByZeroDrop")
    check("example/even2/even2")
    check("example/even3/even3")
    check("example/evenList/evenList")
    check("example/factorial/factorial")
    check("example/fibonacci/fibonacci")
    check("example/force-lam/force-lam")
    check("example/IfIntegers/IfIntegers")
    check("example/NatRoundTrip/NatRoundTrip")
    check("example/overapplication/overapplication")
    check("example/ScottListSum/ScottListSum")
    check("example/succInteger/succInteger")
    check("term/app/app-1/app-1")
    check("term/app/app-2/app-2")
    check("term/app/app-3/app-3")
    check("term/app/app-4/app-4")
    check("term/app/app-5/app-5")
    check("term/app/app-6/app-6")
    check("term/app/app-7/app-7")
    check("term/app/app-8/app-8")
    check("term/app/app-9/app-9")
    check("term/argExpected/argExpected")
    check("term/case/case-01/case-01")
    check("term/case/case-02/case-02")
    check("term/case/case-03/case-03")
    check("term/case/case-04/case-04")
    check("term/case/case-05/case-05")
    check("term/case/case-06/case-06")
    check("term/case/case-07/case-07")
    check("term/case/case-08/case-08")
    check("term/case/case-09/case-09")
    check("term/case/case-10/case-10")
    check("term/closure/closure")
    check("term/constr/constr-01/constr-01")
    check("term/constr/constr-02/constr-02")
    check("term/constr/constr-03/constr-03")
    check("term/constr/constr-04/constr-04")
    check("term/constr/constr-05/constr-05")
    check("term/constr/constr-06/constr-06")
    check("term/constr/constr-07/constr-07")
    check("term/constr/constr-08/constr-08")
    check("term/constr/constr-09/constr-09")
    check("term/constr/constr-10/constr-10")
    check("term/delay/delay-error-1/delay-error-1")
    check("term/delay/delay-error-2/delay-error-2")
    check("term/delay/delay-lam/delay-lam")
    check("term/force/force-1/force-1")
    check("term/force/force-2/force-2")
    check("term/force/force-3/force-3")
    check("term/force/force-4/force-4")
    check("term/lam/lam-1/lam-1")
    check("term/lam/lam-2/lam-2")
    check("term/nonFunctionalApplication/nonFunctionalApplication")
    check("term/unlifting-sat/unlifting-sat")
    check("term/unlifting-unsat/unlifting-unsat")
    check("term/var/var")
    // constant-case tests for bool and integer
    check("term/constant-case/bool/bool-01/bool-01")
    check("term/constant-case/bool/bool-02/bool-02")
    check("term/constant-case/bool/bool-03/bool-03")
    check("term/constant-case/bool/bool-04/bool-04")
    check("term/constant-case/bool/bool-05/bool-05")
    check("term/constant-case/bool/bool-06/bool-06")
    check("term/constant-case/bool/bool-07/bool-07")
    check("term/constant-case/integer/integer-01/integer-01")
    check("term/constant-case/integer/integer-02/integer-02")
    check("term/constant-case/integer/integer-03/integer-03")
    check("term/constant-case/integer/integer-04/integer-04")
    // Plutus 1.53 - constant-case tests for list
    check("term/constant-case/list/list-01/list-01")
    check("term/constant-case/list/list-02/list-02")
    check("term/constant-case/list/list-03/list-03")
    check("term/constant-case/list/list-04/list-04")
    check("term/constant-case/list/list-05/list-05")
    check("term/constant-case/list/list-06/list-06")
    check("term/constant-case/list/list-07/list-07")
    check("term/constant-case/pair/pair-01/pair-01")
    check("term/constant-case/pair/pair-02/pair-02")
    check("term/constant-case/pair/pair-03/pair-03")
    check("term/constant-case/pair/pair-04/pair-04")
    check("term/constant-case/pair/pair-05/pair-05")
    check("term/constant-case/unit/unit-01/unit-01")
    check("term/constant-case/unit/unit-02/unit-02")
    check("term/constant-case/unit/unit-03/unit-03")

    private type EvalFailure = "evaluation failure"
    private type ParseError = "parse error"
    private type Error = EvalFailure | ParseError
    private def parseExpected(code: String): Either[Error, Term] = {
        code match
            case "evaluation failure" => Left("evaluation failure")
            case "parse error"        => Left("parse error")
            case _ =>
                Program.parseUplc(code) match
                    case Left(value) => fail(s"Unexpected parse error: $value")
                    case Right(program) =>
                        Right(DeBruijn.deBruijnTerm(program.term))

    }

    private def eval(code: String): Either[Error, Result] = {
        Program.parseUplc(code) match
            case Right(program) =>
                Right(program.term.evaluateDebug)
            case Left(_) =>
                Left("parse error")
    }

    protected def readFile(path: String): String = {
        new String(platform.readFile(path), "UTF-8")
    }

    protected def path = s"plutus-conformance/test-cases/uplc/evaluation"

    private val BudgetRegex = """\(\{cpu:\s(\d+)\n\|\smem:\s(\d+)\}\)""".r

    protected def check(name: String): Unit =
        test(name) {
            val code = readFile(s"$path/$name.uplc")
            val expected = readFile(s"$path/$name.uplc.expected")
            val expectedBudget =
                val budget = Try(readFile(s"$path/$name.uplc.budget.expected"))
                budget match
                    case Success(BudgetRegex(cpu, mem)) =>
                        Right(ExBudget.fromCpuAndMemory(cpu.toLong, mem.toLong))
                    case Success("parse error") => Left("parse error")
                    case Success("evaluation failure") => Left("evaluation failure")
                    case Failure(_) => Left("no file")
                    case _ => fail(s"Unexpected budget format:\n$budget")
            
            // println(eval(code).show)
            (eval(code), parseExpected(expected), expectedBudget) match
                case (Right(Result.Success(actualTerm, budget, _, _)), Right(expectedTerm), expectedBudget) =>
                    assert(actualTerm _== expectedTerm, s"Expected $expectedTerm but got $actualTerm")
                    expectedBudget match
                        case Right(expectedBudget) =>
                            assert(budget == expectedBudget, s"Expected $expectedBudget but got $budget")
                        case Left("no file") => // ignore
                        case Left(e) => fail(s"Expected $e but got $budget")
                case (Right(Result.Failure(actualTerm, _, _, _)), Left("evaluation failure"), Left("evaluation failure")) =>
                    assert(true)
                case (Left(e1), Left(e2), Left(_)) => assert(e1 == e2)
                case (a, b, c)               => fail(s"Expected $b but got $a and budget $c")
        }